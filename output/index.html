<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://expdemos.com/">
<meta name="description" content="experiment demos &amp; presentation">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>expdemos</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://expdemos.com/">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/beginner%20python/" type="text/html">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://expdemos.com/">

                <span id="blog-title">expdemos</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="archive.html">Archive</a>
                </li>
<li>
<a href="categories/">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/beginner%20python/" class="u-url">beginner python</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                enigma
            </span></p>
            <p class="dateline"><a href="posts/beginner%20python/" rel="bookmark"><time class="published dt-published" datetime="2016-06-17T06:00:00Z" title="2016-06-17 06:00">2016-06-17 06:00</time></a></p>
                <p class="commentline">
        


        </p>
</div>
    </header><div class="e-content entry-content">
    <div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">代码风格</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">utf-8</h3>
<div class="outline-text-3" id="text-1-1">
<div class="highlight"><pre><span></span><span class="err">文件开头统一添加</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="err">或</span>
<span class="c1"># coding=utf-8</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">名称</h3>
<div class="outline-text-3" id="text-1-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">类型</th>
<th scope="col" class="left">常规名</th>
<th scope="col" class="left">内部名</th>
</tr></thead>
<tbody>
<tr>
<td class="left">变量</td>
<td class="left">lower_with_under</td>
<td class="left">_lower_with_under</td>
</tr>
<tr>
<td class="left">函数</td>
<td class="left">lower_with_under()</td>
<td class="left">_lower_with_under()</td>
</tr>
<tr>
<td class="left">类</td>
<td class="left">CapWords</td>
<td class="left">_CapWords</td>
</tr>
<tr>
<td class="left">包</td>
<td class="left">lower_with_under</td>
<td class="left"> </td>
</tr>
<tr>
<td class="left">全局常量</td>
<td class="left">CAPS_WITH_UNDER</td>
<td class="left">CAPS_WITH_UNDER</td>
</tr>
<tr>
<td class="left">异常</td>
<td class="left">CapWords</td>
<td class="left">CapWords</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">缩进</h3>
<div class="outline-text-3" id="text-1-3">
<p>
使用四个空格缩进 <br>
设置编辑器 tab = 4 空格
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">函数</h3>
<div class="outline-text-3" id="text-1-4">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fetch_bigtable_rows</span><span class="p">(</span><span class="n">big_table</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">other_silly_variable</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">"""Fetches rows from a Bigtable.</span>

<span class="sd">    Retrieves rows pertaining to the given keys from the Table instance</span>
<span class="sd">    represented by big_table.  Silly things may happen if</span>
<span class="sd">    other_silly_variable is not None.</span>

<span class="sd">    Args:</span>
<span class="sd">	big_table: An open Bigtable Table instance.</span>
<span class="sd">	keys: A sequence of strings representing the key of each table row</span>
<span class="sd">	    to fetch.</span>
<span class="sd">	other_silly_variable: Another optional variable, that has a much</span>
<span class="sd">	    longer name than the other args, and which does nothing.</span>

<span class="sd">    Returns:</span>
<span class="sd">	A dict mapping keys to the corresponding table row data</span>
<span class="sd">	fetched. Each row is represented as a tuple of strings. For</span>
<span class="sd">	example:</span>

<span class="sd">	{'Serak': ('Rigel VII', 'Preparer'),</span>
<span class="sd">	 'Zim': ('Irk', 'Invader'),</span>
<span class="sd">	 'Lrrr': ('Omicron Persei 8', 'Emperor')}</span>

<span class="sd">	If a key from the keys argument is missing from the dictionary,</span>
<span class="sd">	then that row was not found in the table.</span>

<span class="sd">    Raises:</span>
<span class="sd">	IOError: An error occurred accessing the bigtable.Table object.</span>
<span class="sd">    """</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">类</h3>
<div class="outline-text-3" id="text-1-5">
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SampleClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">"""Summary of class here.</span>

<span class="sd">    Longer class information....</span>
<span class="sd">    Longer class information....</span>

<span class="sd">    Attributes:</span>
<span class="sd">	likes_spam: A boolean indicating if we like SPAM or not.</span>
<span class="sd">	eggs: An integer count of the eggs we have laid.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">likes_spam</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
	<span class="sd">"""Inits SampleClass with blah."""</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">likes_spam</span> <span class="o">=</span> <span class="n">likes_spam</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">eggs</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">public_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">"""Performs operation blah."""</span>
</pre></div>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6">import</h3>
<div class="outline-text-3" id="text-1-6">
<p>
1 标准库
</p>
<p>
2 第三方库
</p>
<p>
3 应用程序指定
</p>
<div class="highlight"><pre><span></span><span class="c1"># Good</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Bad</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
</pre></div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7">工具</h3>
<div class="outline-text-3" id="text-1-7">
<ul class="org-ul">
<li>
<a href="https://pypi.python.org/pypi/autopep8">Autopep8</a>
</li>
<li>
<a href="https://pypi.python.org/pypi/pycodestyle">pycodestyle</a>
</li>
<li>
<a href="https://github.com/google/yapf">yapf</a>
</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">pip</h2>
<div class="outline-text-2" id="text-2">
<p>
<a href="https://pypi.python.org/pypi/pip">pip</a> 是一个用来安装和管理 Python 包的工具
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">示例</h3>
<div class="outline-text-3" id="text-2-1">
<div class="highlight"><pre><span></span># 指定版本
pip install pandas=2.0.1
</pre></div>

<div class="highlight"><pre><span></span># 安装所有依赖关系
pip install -r requirement.txt
</pre></div>

<div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">virtualenv</h2>
<div class="outline-text-2" id="text-3">
<p>
virtualenv 用于创建多个独立的 Python 虚拟运行环境
</p>
<ul class="org-ul">
<li>在没有权限的情况下安装包
</li>
<li>不同项目可以使用不同的包组合
</li>
<li>包版本升级不影响其他项目
</li>
</ul>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">示例</h3>
<div class="outline-text-3" id="text-3-1">
<div class="highlight"><pre><span></span># 创建新环境
virtualenv venv
</pre></div>

<div class="highlight"><pre><span></span># 启动虚拟环境
source venv/bin/activate
</pre></div>

<div class="highlight"><pre><span></span># 退出虚拟环境
deactivate
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">json</h2>
<div class="outline-text-2" id="text-4">
<p>
JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式
json 模块提供了一种简单的方式来编码和解码 JSON 数据
</p>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">示例</h3>
<div class="outline-text-3" id="text-4-1">
<div class="highlight"><pre><span></span><span class="c1"># 将 python 数据结构转换为 json 串</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'name'</span> <span class="p">:</span> <span class="s1">'ACME'</span><span class="p">,</span>
    <span class="s1">'shares'</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">'price'</span> <span class="p">:</span> <span class="mf">542.23</span>
<span class="p">}</span>
<span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># 从 json 字串中解析数据</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">logging</h2>
<div class="outline-text-2" id="text-5">
<p>
提供了通用的日志系统
</p>
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">示例</h3>
<div class="outline-text-3" id="text-5-1">
<div class="highlight"><pre><span></span><span class="c1"># 设置日志格式</span>
<span class="n">FORMAT</span> <span class="o">=</span> <span class="s1">'</span><span class="si">%(asctime)-15s</span><span class="s1"> </span><span class="si">%(clientip)s</span><span class="s1"> </span><span class="si">%(user)-8s</span><span class="s1"> </span><span class="si">%(message)s</span><span class="s1">'</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="n">FORMAT</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'clientip'</span><span class="p">:</span> <span class="s1">'192.168.0.1'</span><span class="p">,</span> <span class="s1">'user'</span><span class="p">:</span> <span class="s1">'python'</span><span class="p">}</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'tcpserver'</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'Protocol problem: </span><span class="si">%s</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'connection reset'</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span># 打印日志
2016-06-16 22:20:02,165 192.168.0.1 python  Protocol problem: connection reset
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">sqlalchemy</h2>
<div class="outline-text-2" id="text-6">
<p>
sqlalchmey 是一个 ORM(Object-Relational Mapping) 框架
提供一种关系数据库的表结构和 python 对象之间的映射
</p>
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">示例</h3>
<div class="outline-text-3" id="text-6-1">
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">create_engine</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">sessionmaker</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="c1"># 创建对象的基类:</span>
<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="c1"># 定义 User 对象:</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="c1"># 表的名字:</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">'user'</span>

    <span class="c1"># 表的结构:</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># 初始化数据库连接:</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">'mysql+mysqlconnector://root:password@localhost:3306/test'</span><span class="p">)</span>
<span class="c1"># 创建 DBSession 类型:</span>
<span class="n">DBSession</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="c1"># 创建 session 对象:</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">DBSession</span><span class="p">()</span>
<span class="c1"># 创建新 User 对象:</span>
<span class="n">new_user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">'5'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Bob'</span><span class="p">)</span>
<span class="c1"># 添加到 session:</span>
<span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_user</span><span class="p">)</span>
<span class="c1"># 保存到数据库:</span>
<span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">subprocess</h2>
<div class="outline-text-2" id="text-7">
<p>
创建一个子进程用于执行外部命令
</p>
</div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">示例</h3>
<div class="outline-text-3" id="text-7-1">
<div class="highlight"><pre><span></span><span class="c1"># 定义 shell 命令</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s2">"ps aux|grep mysql|grep -v grep|awk '{print $2}'|xargs kill -9"</span>
</pre></div>

<div class="highlight"><pre><span></span><span class="c1"># 执行命令</span>
<span class="k">try</span> <span class="p">:</span>
    <span class="n">exec_output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>

<span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">,</span> <span class="n">exec_err</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Q &amp; A</h2>
<div class="outline-text-2" id="text-8">
<p>
谢谢
</p>
</div>
</div>
    </div>
    </article>
</div>



        





        </div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:jiancheng.pro@gmail.com">enigma</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
